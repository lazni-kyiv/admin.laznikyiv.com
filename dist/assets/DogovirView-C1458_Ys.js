import{a as n,q as $,f as I,x as N,g as w,H as E,s as L,e as O,j as H,o as c,b as s,c as m,d as p,C as T,D as F,F as G,E as J,G as M,n as U,t as S,i as j}from"./index-DfC6sHtH.js";import{A as z}from"./AdminView-DgyvBQoU.js";/* empty css                  */import{D as Q}from"./DogovirActions-dr_83eGJ.js";import{t as q}from"./toastr-CY63SwY8.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Icon-CMnBudPe.js";import"./_commonjsHelpers-CqkleIqs.js";const P={class:"header"},R={class:"header__search"},W={class:"form-input"},X={key:0,class:"guests"},Y={key:0,class:"not-found"},Z={class:"guest__info"},ee={class:"guest__name"},te={class:"guest__id"},se={class:"guest__actions"},oe={__name:"DogovirView",setup(re){const C=n([]),a=n(Array.from({length:10},()=>({}))),d=n("");n(null);const _=n(!0);n(null);const x=$(()=>[...a.value].reverse());n({alias:null,name:null,birthday:null,document:null,phone:null});const u=n([]),h=n([]),A=n("l");I(()=>{N({title:"Договори"}),sessionStorage.getItem("guest-error")=="get-error"&&(q.error("Помилка завантаження гостя"),sessionStorage.removeItem("guest-error")),w.guests.list().then(e=>{C.value=e.guests,a.value=e.guests,_.value=!1}),w.bookings.list().then(e=>{u.value=e.bookings.filter(t=>t.dogovir!==null),h.value=e.bookings.filter(t=>t.dogovir!==null);const r=e.bookings.filter(t=>t.dogovir!==null);a.value.forEach(t=>{let i=0;r.forEach(l=>{l.guest==t.$id&&(i+=1)}),t.bookings=i})})});function B(){u.value=h.value.filter(o=>String(a.value.filter(e=>e.$id==o.guest)[0].name).toLowerCase().includes(String(d.value.trim()).toLowerCase())||String(JSON.parse(o.dogovir).pdf).toLowerCase().includes(String(d.value.trim()).toLowerCase()))}async function D(o,e=6){const t=new TextEncoder().encode(o),i=await crypto.subtle.digest("SHA-256",t),V=Array.from(new Uint8Array(i)).map(f=>f.toString(16).padStart(2,"0")).join("");let g=BigInt("0x"+V.slice(0,16));const b="01234567890123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",k=BigInt(b.length);let v="";for(;g>0n;){const f=g%k;v=b[Number(f)]+v,g=g/k}return`${v.slice(0,e)}`}const y=E({});return L(()=>x.value,async o=>{if(o!=null&&o.length)for(const e of o){const r=e==null?void 0:e.$id;!r||y[r]||(y[r]=await D(r))}},{immediate:!0,deep:!0}),(o,e)=>(c(),O(z,null,{default:H(()=>{var r;return[s("div",P,[e[2]||(e[2]=s("p",{class:"comment"},"Договори",-1)),s("div",R,[s("div",W,[T(s("input",{type:"",placeholder:"Пошук","onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),onInput:e[1]||(e[1]=t=>B())},null,544),[[F,d.value]])])])]),A.value=="l"?(c(),m("div",X,[u.value.length==0?(c(),m("p",Y,"Немає результатів")):p("",!0),((r=u.value)==null?void 0:r.length)>0?(c(!0),m(G,{key:1},J(u.value,(t,i)=>(c(),m("div",{class:U(["guest",{lorem:_.value}]),style:M(`animation-delay: ${.02*i}s`)},[e[3]||(e[3]=s("div",{class:"guest-text"},[s("div",{class:"guest__avatar"},[s("i",{class:"hgi hgi-stroke hgi-signature"})])],-1)),s("div",Z,[s("div",ee,S(JSON.parse(t.dogovir).pdf),1),s("div",te,S(a.value.filter(l=>l.$id==t.guest)[0].name),1)]),s("div",se,[j(Q,{booking:t,guest:a.value.filter(l=>l.$id==t.guest)[0]},null,8,["booking","guest"])])],6))),256)):p("",!0)])):p("",!0)]}),_:1}))}},me=K(oe,[["__scopeId","data-v-5be72ec8"]]);export{me as default};
